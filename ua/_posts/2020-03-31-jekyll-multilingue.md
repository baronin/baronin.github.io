---
title: Створіть багатомовний веб-сайт з jekyll
img: 2
i18n-link: multilingual
categories: [blog]
tags: [ua]
---

Хтось може подумати, що, оскільки Jekyll є генератором статичних веб-сайтів, то не вийде впоратися з інтернаціоналізацією. Але це не так

Насправді, це може бути не так просто, як використовувати PHP-фреймворк, такий як Wordpress. Але після маленьких манепуляцій, ви зможете обслуговувати свої пости і сторінки на будь-якій кількості мов, скільки вам потрібно.
Оскільки ця проблема з додаванням багатомовну підтримку на сайт, добре відома, але ви можете знайти і інші методи в stackoverflow або інших блогах, орієнтованих на webdev-.

## Історія папок

Перш ніж почати говорити про Багатомовність на сайті, було б здорово пояснити, як Jekyll управляє папками всередині вашого проекту. Як докладно описано в документації Jekyll, існує два види папок / файлів.

### Parsed folders/files

Спочатку ті, які будуть проаналізовані Джекілом, а потім, для деяких, оброблені. Вони завжди починаються з `_` (наприклад, `_posts`, `_layouts`, `_include`, `_config.yml`). Ви не побачите їх в URL, оскільки Jekyll не розкриває їх безпосередньо. Ви можете бачити їх як інгредієнти, використовувані для білду проекту.

### Exposed folders/files

Раніше ми бачили папки і файли, що починаються з `_`. Отже, всі інші ресурси, не починаються з нижнього подчерковинія, будуть просто скопійовані Джекілл в ваш кінцевий сайт `_site`.
Це може бути `scss`, `fonts`, `image`, `XML` і т. Д. Але що, якщо ми помістимо проаналізовані ресурси в порожню папку?
Ресурс (наприклад, файл з `markdown `) буде відображений у вашій недавно створеної папці.
Потім ви можете отримати доступ до post або сторінці, 
подивившись його URL (наприклад, `/my-cool-folder/2016/03/02/my-post.html` - цей `post`  в `my-cool-folder`).

Це дуже цікава особливість інтернаціоналізації ...

## Створіть загальний міжнародний сайт

Переклад вашого сайту на іншу мову, це те, про що ми повинні подумати на самому початку його розвитку.
Якщо ваш сайт добре підготовлений до перекладу, переклад сторінок буде дуже простий на будь-яку мову.
Ваш `layout`  залишається колишнім, тільки included рядки будуть залежати від вибраної мови.

На візуалізованому(server-side rendered) веб-сайті на стороні сервера ваша робота полягає в створенні прихованої логіки.
Я можу взяти приклад Symfony, який використовує движок гілок для візуалізації уявлень.
Все, що вам потрібно зробити, це написати свої макети, вказати, куди будуть поміщені ваші перекладені ресурси, заповнити конфігураційні файли різними активами, а потім спостерігати за чарами!

Але як сервер дізнається, що ваш відвідувач говорить на одному з мов?

По-перше, вони можуть прочитати HTTP-заголовок ACCEPT_LANGUAGE.
Коли заголовок визначено, заголовок повинно вказувати на те, що є основною мовою відвідувача.
Але що, якщо ваш відвідувач захоче прочитати ваш сайт іншою мовою, ніж основний?
Ви повинні дозволити йому вибрати мову, на якому буде відображатися ваш контент, наприклад, за допомогою блоку `<select>`.
Але почекайте, тоді вашому відвідувачеві доведеться вибирати свою мову для кожної сторінки вашого сайту?
Це не те, що ви, можливо, захочете змусити його зробити.

Ви також можете використовувати свій URL, наприклад, цей блог.
Так, українська версія кожного повідомлення доступна через префікс `/ ua /`.
Інші веб-сайти створюють новий піддомен для кожної мови, тому ви можете просто перейти за адресою: `lang.my-site.com`.

## Multilingual website, the Jekyll way

Ви можете знайти багато інших хороших методів в Інтернету,
але тут я збираюся показати вам, як об'єднати все, про що ми говорили раніше  :`folders` and `URL`.
Ці два посилання ефективний спосіб показати вашому відвідувачеві сторінку на обраному їм мовою без головного болю

### The structure

Наш проект буде виглядати так:

~~~
project/
	_drafts/
	_includes/
	_layouts/
	_posts/
        my-translated-post.md
	_site/
    _sass
	ua/
		_posts/
			my-translated-post.md
		index.md
	index.md
~~~

Я приведу тут приклад української веб-сайту (який сюрприз!).

Як ви можете бачити, ця структура точно така ж, як уже відома вам структура (базова структура jekyll), але з новою папкою: `ua`.
Наша нова папка з ім'ям мовного ідентифікатора містить всі ваші перекладні файли (всі ваші post, pages, drafts і ін. index.md).
Ви можете перевести, назва вашого поста (це може бути дуже важливе для SEO).
Таким чином, кожен раз, коли ви пишете новий пост або сторінку, просто створіть новий файл в своєму `ua/` (Або як ви його назвали) з тим же шляхом і створіть папки, що містять цей файл.

### Front matter, matters

Це те, що робить Jekyll дійсно крутим, і те, що робить цей метод функціональним!
Для кожного `post` або `page` ми створимо унікальний ідентифікатор.
Цей ідентифікатор буде використовуватися пізніше, щоб зв'язати наші сторінки разом, щоб ми могли знайти перекладену версію поточної сторінки.
Я назвав це `i18n-link`... чому б і ні?
Так що ваш пост повинен виглядати так : `_posts/mon-billet-traduit.md`

~~~ yaml
---
title: My translated post !
i18n-link: translated-post
---

Hey ! This is a pretty cool translated post !
~~~

І ваш перекладений пост: `ua/_posts/my-translated-post.md`

~~~ yaml
---
title: Мій переведений пост !
i18n-link: translated-post
---

Вітання ! Це досить крутий перекладної пост!
~~~

Легко, чи не так? Для наступного поста вам просто потрібно замінити i18n-посилання нової унікальної посиланням.

Ваш переклад тепер повністю функціональний. Так, дійсно! 
Якщо ви хочете отримати доступ до вашого переведеному повідомленням, вам просто потрібно додати prefix `/ua/` вашому URL.
Але ви не захочете просити ваших відвідувачів зробити це, так?
Не було б здорово генерувати мовні кнопки для доступу до переведеним версіями ваших повідомлень?

### Add language selection

Ось так, переклад поста це круто. Доступ до перекладеного посту через URL - це також круто.
Але автоматично відображати доступні переклади для сторінки і створювати посилання крутіше!

Отже, давайте просто підготуємо наш код:

{% raw %}
~~~ html
<div class="lang">
  <ul>
    <li>UA</li>
    <li>EN</li>
    <li>CH</li>
  </ul>
</div>
~~~
{% endraw %}

Добре, це приблизно те, що ми хочемо згенерувати: список наших доступних мов. Кожна мова буде посилатися на один з наших переведених постів
Приблизно так `/{lang}/my-cool-post`

Наш url автоматично генерується і надається Jekyll з атрибутом `url` поста. Як це

{% raw %}
~~~ html
<div class="lang">
  <ul>
    <li><a class="UA" href="{{ site.base-url }}{{ postUA.url }}">UA</a></li>
    <li><a class="EN" href="{{ site.base-url }}{{ postEN.url }}">EN</a></li>
    <li><a class="CH" href="{{ site.base-url }}{{ postCH.url }}">CH</a></li>
  </ul>
</div>
~~~
{% endraw %}

`site.base-url` це базовий URL нашого сайту. Наприклад, якщо корінь нашого веб-сайту знаходиться в папці, 
ми помістимо шлях до папки в цю змінну [liquid](https://shopify.github.io/liquid/).

Так що тепер у нас є наш URL для кожного перекладу нашого поста. Але було б здорово (не обов'язково) дозволити Джекілл знайти переклади, доступні для нашого поста.
Припустимо, ви не перевели свій пост на китайський, чи хочете ви, щоб у вашому меню була непрацююча посилання? Я сподіваюся, що ви відповіли - ні.

Нам потрібно буде знайти всі переклади з одного і того ж поста. Для цього нам доведеться використовувати нашу змінну `i18n-link`, певну раніше.
Це дозволить легко зв'язати наші переклади разом.
{% raw %}
~~~ liquid
{% assign posts=site.posts | where:"i18n-link", page.i18n-link | sort: 'lang' %}
~~~
{% endraw %}

`site.posts` містить всі повідомлення нашого веб-сайту `jekyll`, тому ми просто шукаємо повідомлення,
в яких посилання `i18n-link` дорівнює посиланням `i18n-link` нашої поточної сторінки.
І щоб бути впевненим в тому, що наша мова списків впорядкований по сторінках, ми їх сортуємо.

Ви також можете зробити це для `pages`:

{% raw %}
~~~ liquid
{% if posts.size == 0 %}
  {% assign posts=site.pages | where:"i18n-link", page.i18n-link | sort: 'lang' %}
{% endif %}
~~~
{% endraw %}

Тепер давайте використаємо наших нових `posts` змінної:

{% raw %}
~~~ html
<div class="lang">
  <ul>
    {% for post in posts %}
      <li><a class="{{ post.lang }}" href="{{ site.base-url }}{{ post.url }}">{{ post.lang }}</a></li>
    {% endfor %}
  </ul>
</div>
~~~
{% endraw %}

І це все. Він буде відображати посилання для кожного перекладу, знайденого на нашій поточній сторінці.

Сьогодні у мене гарний настрій, ось повний код:

{% raw %}
~~~ html
{% assign posts=site.posts | where:"i18n-link", page.i18n-link | sort: 'lang' %}

{% if posts.size == 0 %}
  {% assign posts=site.pages | where:"i18n-link", page.i18n-link | sort: 'lang' %}
{% endif %}

<div class="lang">
  <ul>
    {% for post in posts %}
      <li><a class="{{ post.lang }}" href="{{ site.base-url }}{{ post.url }}">{{ post.lang }}</a></li>
    {% endfor %}
  </ul>
</div>
~~~
{% endraw %}

### Configurer Jekyll

У нас хороша структура папок і хороша візуалізація пост-перекладу. Тепер давайте завершимо наш багатомовний веб-сайт, налаштувавши Jekyll.

Що ми хочемо зробити, це встановити наші змінні залежно від поточного перекладу. Оскільки наш спосіб роботи використовує папки, ми також будемо використовувати їх для визначення мови.
~~~ yaml
defaults:
    -
     scope:
         path: ""
     values:
         author: "moi"
         layout: monLayout
         lang: ua
         base-url: "/"
    -
     scope:
         path: en
     values:
         lang: en
         base-url: "/en/"
    -
     scope:
         path: ch
     values:
         lang: ch
         base-url: "/ch/"
~~~

`defaults ` yaml встановлюється областю дії. Одна область на переклад. Область дії за замовчуванням тут `en`,
де ми визначимо всі змінні за замовчуванням для нашого застосування. Потім ми просто переобумовленої їх для кожної області.
Наші повідомлення тепер отримають змінні `lang` і `base-url`, певні в залежності від нашого перекладу.


### Translate layouts

Ми побачили, як перевести весь пост. Але що, якщо ми хочемо перевести наш макет?

Можливо, ви захочете визначити, де частина вашого макета повинні бути переведені. Для цього ми знову будемо використовувати змінні Liquid. наприклад:

{% raw %}
~~~ liquid
<h1>{{ site.t['title'][page.lang] }}</h1>
~~~
{% endraw %}

Ми знову використовуємо нашу змінну `page.lang`, щоб отримати поточну мову, і використовуємо його в якості індексу для нашого перекладу.

Потім нам просто потрібно додати наш масив `site.t` в файл конфігурації і заповнити його:

~~~ yaml
t:
    title:
        en: "Title"
        ua: "Titre"
    subtitle:
        en: "Subtitle"
        ua: "Sous-titre"
~~~

## Висновок

Тепер ви можете легко перевести весь ваш сайт Jekyll. Не соромтеся персоналізувати код, вказаний в цьому пості, для своїх потреб.

Це був довгий пост, тому деякі помилки могли підкрастися. Ви можете запропонувати виправлення, використовуючи кнопку github внизу цієї частини.

Веселої роботи з Джекілл! :D